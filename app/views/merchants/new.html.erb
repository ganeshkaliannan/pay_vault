<div class="page-container">
  <div class="page-header">
    <div class="page-icon">âž•</div>
    <div>
      <h1>Create New Merchant</h1>
      <p>Add a new merchant account to the system</p>
    </div>
  </div>

  <div class="settings-content">
    <%= form_with model: @merchant, url: merchants_path, local: true do |f| %>
      <% if @merchant.errors.any? || @user.errors.any? %>
        <div class="alert alert-danger">
          <h4><%= pluralize(@merchant.errors.count + @user.errors.count, "error") %> prohibited this merchant from being saved:</h4>
          <ul>
            <% @user.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
            <% @merchant.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="setting-group">
        <h3>Login Credentials</h3>
        <%= fields_for :user, @user do |user_fields| %>
          <div class="form-group">
            <%= user_fields.label :email, "Login Email" %>
            <%= user_fields.email_field :email, class: "form-input", required: true, placeholder: "merchant@example.com" %>
            <p class="help-text">This will be used for login</p>
          </div>
          <div class="form-group">
            <%= user_fields.label :password %>
            <%= user_fields.password_field :password, class: "form-input", required: true, minlength: 6 %>
            <p class="help-text">Minimum 6 characters</p>
          </div>
          <div class="form-group">
            <%= user_fields.label :password_confirmation, "Confirm Password" %>
            <%= user_fields.password_field :password_confirmation, class: "form-input", required: true %>
          </div>
        <% end %>
      </div>

      <div class="setting-group">
        <h3>Business Information</h3>
        <div class="form-group">
          <%= f.label :company_name, "Company Name" %>
          <%= f.text_field :company_name, class: "form-input", required: true, placeholder: "Acme Corporation" %>
        </div>
        <div class="form-group">
          <%= f.label :name, "Contact Person Name" %>
          <%= f.text_field :name, class: "form-input", required: true, placeholder: "John Doe" %>
        </div>
        <div class="form-group">
          <%= f.label :email, "Business Email" %>
          <%= f.email_field :email, class: "form-input", required: true, placeholder: "business@acme.com" %>
        </div>
        <div class="form-group">
          <%= f.label :phone, "Phone Number" %>
          <%= f.text_field :phone, class: "form-input", placeholder: "+1234567890" %>
        </div>
      </div>

      <div class="setting-group">
        <h3>Business Details</h3>
        <div class="form-group">
          <%= f.label :tax_id, "Tax ID / EIN" %>
          <%= f.text_field :tax_id, class: "form-input", placeholder: "12-3456789" %>
          <p class="help-text">Business tax identification number</p>
        </div>
        <div class="form-group">
          <%= f.label :business_type %>
          <%= f.select :business_type, 
              [['Sole Proprietorship', 'sole_proprietorship'], 
               ['Partnership', 'partnership'], 
               ['LLC', 'llc'], 
               ['Corporation', 'corporation']], 
              { include_blank: 'Select business type' }, 
              class: "form-input" %>
        </div>
      </div>

      <div class="setting-group">
        <h3>Account Settings</h3>
        <div class="form-group">
          <%= f.label :status %>
          <%= f.select :status, [['Active', 'active'], ['Pending', 'pending'], ['Suspended', 'suspended'], ['Inactive', 'inactive']], {}, class: "form-input" %>
        </div>
        <div class="form-group">
          <%= f.label :currency %>
          <%= f.select :currency, [['USD', 'USD'], ['EUR', 'EUR'], ['GBP', 'GBP'], ['INR', 'INR']], {}, class: "form-input" %>
        </div>
      </div>

      <div class="setting-actions">
        <%= f.submit "Create Merchant", class: "btn btn-primary" %>
        <%= link_to "Cancel", merchants_path, class: "btn btn-secondary" %>
      </div>
    <% end %>
  </div>
</div>
